<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UTF-8 Simple Library for Internationalization: UTF8 - Simple Library for Internationalization</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="utf8-icon-small.png"/></td>
  <td id="projectalign">
   <div id="projectname">UTF-8 Simple Library for Internationalization
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">UTF8 - Simple Library for Internationalization </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="mainpage"></a> Functions to facilitate Windows handling of I18N problems using the strategy advocated by <a href="http://utf8everywhere.org/">UTF-8 Everywhere Manifesto</a>.</p>
<h1>Purpose</h1>
<p >This is a library designed to simplify the usage of UTF-8 strings under Win32. While most of the (computing) world has standardized on using UTF-8 encoding, Win32 has remained stuck with wide character strings (also called UTF-16 encoding).</p>
<p >The library uses the principles outlined in the <a href="http://utf8everywhere.org/">UTF-8 Everywhere Manifesto</a> to make it easy to switch between the different character encodings.</p>
<h1>Content</h1>
<p >The main function groups are:</p><ul>
<li><a class="el" href="group__basecvt.html">Narrowing/widening functions</a></li>
<li><a class="el" href="group__charclass.html">Character classification functions</a></li>
<li><a class="el" href="group__folding.html">Case folding and case-insensitive comparison</a></li>
<li><a class="el" href="group__inifile.html">INI file replacement API</a></li>
<li><a class="el" href="group__reg.html">Registry functions</a></li>
</ul>
<p >There are also functions for:</p><ul>
<li>character counting - <a class="el" href="utf8_8cpp.html#afbcb53fd241b51ed4744eef1d7400a23">length</a></li>
<li>string traversal - <a class="el" href="utf8_8cpp.html#a18d96acd3fe88012740e79857d05b109">next</a></li>
<li>validity checking - <a class="el" href="utf8_8cpp.html#a5efdfa2bb7a6e4d21005f97f79f44bba">valid_str</a></li>
</ul>
<p >In addition to those, there are wrappings for commonly used C and C++ functions:</p><ul>
<li>file access operations: <a class="el" href="utf8_8h.html#a17111250dd542f9ed080a96cab913936">fopen</a>, <a class="el" href="utf8_8h.html#af3ebab9439377a6a3f13542dbab4337c">access</a>, <a class="el" href="utf8_8h.html#a5f0eb1fee50553ad4e55671f52c7f2ec">remove</a>, <a class="el" href="utf8_8h.html#a9a6a50a870135177fb98e9f2e0fb12d4">chmod</a>, <a class="el" href="utf8_8h.html#a1d0245cbb42146a80be6b62c718f61a6">rename</a></li>
<li>directory operations: <a class="el" href="utf8_8h.html#aa6aefa08998a55dca4ba75312126e353">mkdir</a>, <a class="el" href="utf8_8h.html#a42637c506240d2a9bfb1d69dcd083645">rmdir</a>, <a class="el" href="utf8_8h.html#aabb576878dd9ae12de2f0ed0f854f1a4">chdir</a>, <a class="el" href="utf8_8cpp.html#ad489d686670dff8206a2c45a7b237ef1">getcwd</a></li>
<li>symbolic link creation: <a class="el" href="win_8cpp.html#ac1275556865f307d60296437899bcdef">symlink</a></li>
<li>path management: <a class="el" href="utf8_8cpp.html#a5d0ef62a8f148b006b9c6fb6562446e0">splitpath</a>, <a class="el" href="utf8_8cpp.html#a07eb0dcaf69e2d9cbcd7d7b6f203f20a">makepath</a></li>
<li>environment functions: <a class="el" href="utf8_8cpp.html#a445530e19aefad1fde92232c09f37a4f">getenv</a>, <a class="el" href="utf8_8h.html#a7efd70545eb2d60d5ec8136dfc3b37db">putenv</a></li>
<li>conversion of command-line arguments: <a class="el" href="utf8_8cpp.html#a87630aaaeb49685ad3359000aa670c66">getargv</a> and <a class="el" href="utf8_8cpp.html#a611de942130d7b70ff9cfaaa79a1f005">freeargv</a></li>
<li>C++ I/O streams: <a class="el" href="classutf8_1_1ifstream.html">ifstream</a>, <a class="el" href="classutf8_1_1ofstream.html">ofstream</a>, <a class="el" href="classutf8_1_1fstream.html">fstream</a></li>
<li>File enumerating functions: <a class="el" href="win_8cpp.html#a0c90d5556940e211346573f6ad2b58a8">find_first</a>, <a class="el" href="win_8cpp.html#a62db79c86ab71f2fa7cc10dbd6a77e52">find_next</a></li>
<li>A <a class="el" href="classutf8_1_1file__enumerator.html">file enumerator</a> object wrapping find_first/find_next functions.</li>
<li>A simple <a class="el" href="classutf8_1_1buffer.html">buffer class</a> for handling Windows API parameters.</li>
<li><a class="el" href="classutf8_1_1_ini_file.html">IniFile</a> - a class for handling Windows "profile files" API.</li>
<li>Some frequently used Windows functions like <a class="el" href="win_8cpp.html#a5c8bfa90bb0ba20781ec286f6c446d62">MessageBox</a>, <a class="el" href="win_8cpp.html#a1c8d2b8afd76d940d81562e5d72cadf4">LoadString</a>, <a class="el" href="win_8cpp.html#a3a9118219f196710e4ee8f90e94264fc">ShellExecute</a>, <a class="el" href="win_8cpp.html#a009eda842dea241f8e9d570f880b6129">GetTempPath</a>, <a class="el" href="win_8cpp.html#aa80797b33793b653187807c3efcc3df7">GetTempFileName</a>, <a class="el" href="win_8cpp.html#a7f638a67f8042af6ed041b7135bf54c6">GetFullPathName</a>, <a class="el" href="win_8cpp.html#a685832fc48fb24f2a711f047e110db11">CopyFile</a></li>
</ul>
<h1>Usage</h1>
<h2>General</h2>
<p >Before using this library you might want to review the guidelines from the <a href="http://utf8everywhere.org/">UTF-8 Everywhere Manifesto</a>. In particular:</p><ul>
<li>define UNICODE or _UNICODE in your program</li>
<li>for Visual Studio users, make sure "Use Unicode Character Set" option is defined under "General" &gt; "Project Defaults" tab.</li>
<li>for Visual Studio users, add <a href="https://docs.microsoft.com/en-us/cpp/build/reference/utf-8-set-source-and-executable-character-sets-to-utf-8"><code>/utf-8</code></a> option under "C/C++" &gt; "All Options" &gt; "Additional Options".</li>
<li>use only <code>std::string</code> and <code>char\*</code> variables. Assume they all contain UTF-8 encoded strings.</li>
<li>use UTF-16 strings only in arguments to Windows API calls.</li>
</ul>
<p >All functions and classes in this library are included in the <em>utf8</em> namespace. It is a good idea not to have a using directive for this namespace. That makes it more evident in the code where UTF8-aware functions are used.</p>
<p >This is an example of a function call: </p><div class="fragment"><div class="line">std::string dirname = <span class="stringliteral">&quot;ÎµÎ»Î»Î·Î½Î¹ÎºÏŒ&quot;</span>;</div>
<div class="line">utf8::mkdir (dirname);   <span class="comment">//create a directory with a UTF8-encoded name</span></div>
</div><!-- fragment --><p> Most functions mimic the behavior of standard C functions. A notable exception is the access() function. The <a class="el" href="utf8_8h.html#af3ebab9439377a6a3f13542dbab4337c" title="Determines if a file has the requested access permissions.">utf8::access()</a> function returns a bool value while the standard library function returns 0 if the file can be accessed.</p>
<h2>I/O Streams</h2>
<p >Wrappers for C++ I/O streams can be used for file streams with UTF-8 encoded filenames. This is an example of a C++ stream with a weird name and content: </p><div class="fragment"><div class="line">std::string filename = <span class="stringliteral">&quot;ÎµÎ»Î»Î·Î½Î¹ÎºÏŒ&quot;</span>;</div>
<div class="line">std::string filetext{ <span class="stringliteral">&quot;ðŸ˜ƒðŸ˜ŽðŸ˜›&quot;</span> };</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classutf8_1_1ofstream.html">utf8::ofstream</a> u8strm(filename);</div>
<div class="line"> </div>
<div class="line">u8strm &lt;&lt; filetext &lt;&lt; endl;</div>
<div class="line">u8strm.close ();</div>
<div class="ttc" id="aclassutf8_1_1ofstream_html"><div class="ttname"><a href="classutf8_1_1ofstream.html">utf8::ofstream</a></div><div class="ttdoc">Output stream class using UTF-8 filename.</div><div class="ttdef"><b>Definition:</b> utf8.h:168</div></div>
</div><!-- fragment --><p> Translation from UTF-16 to UTF-8 applies only to file names. C++ streams are agnostic about their content.</p>
<p >Calling Windows API functions can be handled using the generic widening and narrowing functions like this example: </p><div class="fragment"><div class="line">std::string filename = <span class="stringliteral">&quot;ÎµÎ»Î»Î·Î½Î¹ÎºÏŒ&quot;</span>;</div>
<div class="line">HANDLE f = CreateFile (<a class="code hl_function" href="group__basecvt.html#gade5f928144a0219a3725921de8cf8188">utf8::widen</a> (filename).c_str (), GENERIC_READ, 0,</div>
<div class="line">  NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);</div>
<div class="ttc" id="agroup__basecvt_html_gade5f928144a0219a3725921de8cf8188"><div class="ttname"><a href="group__basecvt.html#gade5f928144a0219a3725921de8cf8188">utf8::widen</a></div><div class="ttdeci">std::wstring widen(const char *s, size_t nch)</div><div class="ttdoc">Conversion from UTF-8 to wide character.</div><div class="ttdef"><b>Definition:</b> utf8.cpp:137</div></div>
</div><!-- fragment --><h2>INI File Handling</h2>
<p >INI files, also called "profile files" in Microsoft parlance are still widely used for storing application settings used either for compatibility reasons or because they are simple to work with.</p>
<p >The problem is that the basic Windows API calls for reading and writing INI files, <code>GetPrivateProfileString</code> and <code>PutPrivateProfileString</code>, combine both the file name and the information to be read or written in one API call. As an example, here is the signature of the <code>GetPrivateProfileStringW</code> function: </p><div class="fragment"><div class="line">DWORD GetPrivateProfileStringW(</div>
<div class="line">  LPCWSTR lpAppName,</div>
<div class="line">  LPCWSTR lpKeyName,</div>
<div class="line">  LPCWSTR lpDefault,</div>
<div class="line">  LPWSTR  lpReturnedString,</div>
<div class="line">  DWORD   nSize,</div>
<div class="line">  LPCWSTR lpFileName</div>
<div class="line">);</div>
</div><!-- fragment --><p> Using the <code><a class="el" href="group__basecvt.html#gade5f928144a0219a3725921de8cf8188" title="Conversion from UTF-8 to wide character.">utf8::widen</a></code> function to convert all UTF-8 strings would produce an INI file that contains UTF-16 characters.</p>
<p >The solution is to completely forget about the Windows API functions and roll a new implementation for accessing INI files. This is by far not the only implementation of INI files that you can find out there. For a list of implementations you can check the <a href="https://en.wikipedia.org/wiki/INI_file">Wikipedia page</a>. This implementation struggles to be as compatible as possible with the original Windows API.</p>
<p >The only changes compared to the Windows API are:</p><ul>
<li>line length defaults to 1024 (the INI_BUFFER_SIZE value) while Windows limits it to 256 characters</li>
<li>files without a path are in current directory while Windows places them in Windows folder</li>
</ul>
<h2>Case Conversion</h2>
<p >Case conversion in Unicode is a much more complicated issue than ASCII case conversion. This library uses standard tables published by Unicode Consortium to perform upper case to lower case conversions. There is also a function <code>icompare()</code> that performs string comparison ignoring the case.</p>
<h1>Building</h1>
<p >The UTF8 library doesn't have any dependencies. The test programs however uses the <a href="https://github.com/neacsum/utpp">UTTP library</a>.</p>
<p >You can use the <a href="https://github.com/neacsum/cpm">CPM - C/C++ Package Manager</a> to fetch all dependent packages and build them. Just issue the <code>cpm</code> command.</p>
<p >The Visual C++ projects are set to compile under C++14 rules and they also compiles fine under C++17 rules. If you are using C++20 rules, you have to add the <a href="https://learn.microsoft.com/en-us/cpp/build/reference/zc-char8-t?view=msvc-170"><code>Zc:char8_t-</code></a> option.</p>
<p >Alternatively, <code>BUILD.bat</code> script will build the libraries and test programs.</p>
<h1>License</h1>
<p >The MIT License (MIT)</p>
<p >Copyright (c) 2014-2023 Mircea Neacsu</p>
<p >Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
<p >The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>
<p >THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
